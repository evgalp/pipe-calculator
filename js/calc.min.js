function RollingMill(e,t,i,n,o,r,l,a,s,c,u,d,h,f,p){return this.baseRollDiameter=e,this.sigmaHalf=t,this.sigma=2*this.sigmaHalf,this.alpha=serviceModule.toRadians(i),this.n=n,this.carriageStrokeLength=o,this.L=r,this.carriageStrokeLengthRotational=l,this.reductionSectionLength=a,this.trunnionDiameter=s,this.DkDcMax=c,this.m=u,this.mx=d,this.reductionZoneLength=h,this.frequency=f,this.mMax=p,this}function Route(e,t,i,n,o,r){return this.billetDiameterInitial=e,this.billetDiameterFinal=t,this.billetWallThicknessInitial=i,this.billetWallThicknessFinal=n,this.billetLengthInitial=o,this.billetWallThicknessInitial<=1&&(this.sigmaT=.12),this.billetWallThicknessInitial>1&&(this.sigmaT=.1),this.pauseTime=r,this}function Material(e,t){return this.sigmaB1=e,this.sigmaB2=t,this}String.prototype.float=function(){return parseFloat(this.replace(",","."))};var serviceModule=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e*(Math.PI/180)}function i(t,n){var o=[];return t.forEach(function(t){e(t)?o.push(t.toFixed(n)):t.constructor===Array?o.push(i(t,n)):o.push(t)}),o}return{isNumber:e,toRadians:t,roundNumericArrayValues:i}}(),calcModule=function(){function e(e,t){return rollSize={},rollSize.rebordDiameter=(e.baseRollDiameter-e.sigmaHalf)*Math.sin(e.alpha),rollSize.bottomRollDiameter=e.baseRollDiameter-t.billetDiameterFinal,rollSize.rebordMinimalThickness=t.billetDiameterFinal/2*.7*(1-Math.cos(e.alpha)),rollSize.effectiveRollDiameter=rollSize.bottomRollDiameter+.2*t.billetDiameterFinal,rollSize.alpha=serviceModule.toRadians(180/e.n),rollSize.beta=serviceModule.toRadians(15),rollSize}function t(e,t){var i={};return i.workLength=e.carriageStrokeLength/(1+e.DkDcMax),i.lb=e.L-i.workLength,i.ln=e.carriageStrokeLengthRotational/(1+e.DkDcMax),i.Yn=t.billetDiameterInitial/2-t.billetDiameterFinal/2,i.Yp=t.billetWallThicknessInitial-t.billetWallThicknessFinal,i.slope=(i.Yn-i.Yp)/e.reductionSectionLength,i.slope<=.06?i.slopeIsNormal=!0:i.slopeIsNormal=!1,i.elongation=(t.billetDiameterInitial-t.billetWallThicknessInitial)*t.billetWallThicknessInitial/((t.billetDiameterFinal-t.billetWallThicknessFinal)*t.billetWallThicknessFinal),i.horizontalSection=e.m*i.elongation/e.DkDcMax,i.calibratingSection=4*i.elongation*e.m/(rollSize.effectiveRollDiameter/e.trunnionDiameter),i.wallReductionSection=i.workLength-(i.ln+e.reductionSectionLength+i.horizontalSection+i.calibratingSection),i}function i(e,t){var i={};i.oneSectionLength=guidePlane.wallReductionSection/7,i.tp=parseFloat(t.sigmaT)+parseFloat(t.billetWallThicknessInitial),i.ut=i.tp/t.billetWallThicknessFinal;var n=[];n[0]=(i.ut+4.333)/5.333,n[1]=(i.ut+1.9091)/2.9091,n[2]=(i.ut+.8824)/1.8824,n[3]=(i.ut+.5238)/1.5238,n[4]=(i.ut+.28)/1.28,n[5]=(i.ut+.1236)/1.1236,n[6]=i.ut,i.u=n,i.t=n.map(function(e){return i.tp/e}),i.yp=i.tp-t.billetWallThicknessFinal,i.yi=i.t.map(function(e){return e-t.billetWallThicknessFinal}),i.bp=i.yp*e.L/(.5*guidePlane.lb+guidePlane.calibratingSection+guidePlane.horizontalSection+7*i.oneSectionLength);var o=[1,2,3,4,5,6,7];return i.bi=i.yi.map(function(t,n){return t*e.L/(.5*guidePlane.lb+guidePlane.calibratingSection+guidePlane.horizontalSection+(7-o[n])*i.oneSectionLength)}),rollSize.delta=(i.tp-i.t[0])/Math.sin(rollSize.alpha),rollSize.gamma=Math.asin(rollSize.delta/t.billetDiameterFinal),rollSize.reductionRadius=t.billetDiameterFinal/2*(1+(4*Math.pow(Math.cos(rollSize.alpha+rollSize.gamma),2)-1)/(2-2*Math.cos(rollSize.beta)*Math.cos(rollSize.alpha+rollSize.gamma))),i}function n(e,t,i){var n={};return n.wallReductionOne=guidePlaneProfile.tp-guidePlaneProfile.t[0],n.wallReductionTwo=guidePlaneProfile.t[0]-guidePlaneProfile.t[1],n.rogr=rollSize.bottomRollDiameter/2,n.deltaOne=.35*Math.sqrt(n.rogr/n.wallReductionOne),n.deltaTwo=.35*Math.sqrt(n.rogr/n.wallReductionTwo),n.elongationOne=guidePlaneProfile.tp/guidePlaneProfile.t[0],n.elongationTwo=guidePlaneProfile.tp/guidePlaneProfile.t[1],n.epsilonOne=100*(1-1/n.elongationOne),n.epsilonTwo=100*(1-1/n.elongationTwo),n.k1=1.05*i.sigmaB1,n.k2=1.05*i.sigmaB2,n.forwardSlipZonePressureOne=n.k1/n.deltaOne*((n.deltaOne-1)*Math.pow(guidePlaneProfile.tp/guidePlaneProfile.t[0],n.delta)-1),n.backwardSlipZonePressureOne=n.k1/n.deltaOne*((n.deltaOne-1)*Math.pow(guidePlaneProfile.tp/guidePlaneProfile.t[0],n.deltaOne)-1),n.backwardSlipZonePressureTwo=n.k2/n.deltaTwo*((n.deltaTwo-1)*Math.pow(guidePlaneProfile.t[0]/guidePlaneProfile.t[1],n.deltaTwo)-1),n.forwardSlipZonePressureOne=n.k1/n.deltaOne*((n.deltaOne+1)*Math.pow(guidePlaneProfile.t[0]/guidePlaneProfile.t[1],n.deltaOne)-1),n.forwardSlipZonePressureTwo=n.k2/n.deltaTwo*((n.deltaTwo+1)*Math.pow(guidePlaneProfile.t[1]/guidePlaneProfile.t[2],n.deltaTwo)-1),n.p1=.5*(n.backwardSlipZonePressureOne+n.forwardSlipZonePressureOne),n.p2=.5*(n.backwardSlipZonePressureTwo+n.forwardSlipZonePressureTwo),n}function o(e,t){var i={};return i.elongationRatio=(t.billetDiameterInitial-t.billetWallThicknessInitial)*t.billetWallThicknessInitial/((t.billetDiameterFinal-t.billetWallThicknessFinal)*t.billetWallThicknessFinal),i.linearShift=e.reductionZoneLength*(i.elongationRatio/(i.elongationRatio-1))*Math.log(e.mx),i.hourProductivity=60/(1e3/(i.linearShift*e.frequency)+t.pauseTime/(60*i.elongationRatio*e.reductionZoneLength)),i}return{calcRollSize:e,calcGuidePlaneSize:t,calcGuidePlaneProfile:i,calcDeformation:n,calcProductivity:o}}(),cacheDomModule=function(){function e(){var e=n.find(".millSelect").val();if("mill_8_15"==e)var t=new RollingMill(53.15,.5,60,3,450,150,69,12,28.5,1.4,4.55,1.055,170,110,9);if("mill_15_30"==e)var t=new RollingMill(82,.5,60,3,455,210,69,12,45,1.6,4.55,1.055,170,90,12);if("mill_30_60"==e)var t=new RollingMill(131,.8,60,3,607,207,69,12,65,1.5,4.55,1.035,170,90,12);if("mill_60_120"==e)var t=new RollingMill(240,1.2,45,4,755,320,69,12,100,1.6,4.55,1.02,170,70,12);return t}function t(){if("steel_20A"==n.find(".materialSelect").val())var e=new Material(660,720);return e}function i(){var e=n.find(".billetDiameterInitial").val().float(),t=n.find(".billetDiameterFinal").val().float(),i=n.find(".billetWallThicknessInitial").val().float(),o=n.find(".billetWallThicknessFinal").val().float();if(n.find(".billetLengthInitial").length)var r=n.find(".billetLengthInitial").val().float();if(n.find(".pauseTime").length)var l=n.find(".pauseTime").val().float();return new Route(e,t,i,o,r,l)}var n=$("#calcForm");return{cacheMill:e,cacheMaterial:t,cacheRoute:i}}(),renderModule=function(){function e(t,i,n){var o=0;for(key in i){null==n&&(n=document.createElement("tr"),t.appendChild(n));var r=document.createElement("td");r.textContent=key,n.appendChild(r);var l=i[key];if("object"!=typeof l){var r=document.createElement("td");r.textContent=l,n.appendChild(r),o+=1}else{var a=e(t,l,n);r.setAttribute("rowspan",a),o+=a}n=null}return o}function t(e,n,o){var r=$("<table></table>");o=void 0==o?0:++o,r.attr("id",n+o),r.attr("class","uk-align-center uk-table uk-table-striped uk-table-hover uk-table-divider");var l=$("<tbody></tbody>");return e.forEach(function(e){var i=$("<tr></tr>");e.forEach(function(e){var r=$("<td></td>");Array.isArray(e)?(e=t([e],n,o),e.attr("class",""),r.append(e)):(e=$("<div></div>").append($('<div class="data"></div>').append(e)).html(),r.append(e)),i.append(r)}),l.append(i)}),r.append(l),$("#calc-result").append(r),i("#"+n+o),r}function i(e){return $(e).each(function(){var t=$(this),i=[];$(e+">tbody>tr").each(function(){var e=0;$(this).find(">td").each(function(){e++,void 0===i[e]&&(i[e]=$("<tr></tr>")),i[e].append($(this))})}),$(e+">tbody>tr").remove(),$.each(i,function(){t.append(this)})}),!1}function n(){$("#domRollSizeTable0").length&&$("#domRollSizeTable0").remove(),$("#domGuidePlaneTable0").length&&$("#domGuidePlaneTable0").remove(),$("#domGuidePlaneProfileTable0").length&&$("#domGuidePlaneProfileTable0").remove(),$("#domDeformationTable0").length&&$("#domDeformationTable0").remove(),$("#domProductivityTable0").length&&$("#domProductivityTable0").remove()}function o(){document.getElementById("clearCalc").addEventListener("click",n())}function r(){t([["Діаметр реборд","Діаметр дна ролика","Мінімальна товщина реборд","Діаметр, що катає","α","β","δ","γ","Радіус випуску"],serviceModule.roundNumericArrayValues(Object.values(rollSize),2),["мм","мм","мм","мм","--","--","--","--","мм"]],"domRollSizeTable")}function l(){t([["Робоча довжина","Сумарна довжина ділянок виходу роликів із зіткнення з металом","Ділянка подачі і повороту","Зниження профілю планки в кінці ділянки подачі","Зниження профілю планки в кінці ділянки редукції","Ухил","Ухил в межах норми","Сумарна витяжка за прохід","Горизонтальна ділянка","Калібрувальна ділянка","Ділянка редукції стінки"],serviceModule.roundNumericArrayValues(Object.values(guidePlane),2),["мм","мм","мм","мм","мм","--","--","мм","мм","мм","мм"]],"domGuidePlaneTable")}function a(){t([["Обтиснення стінки на ділянці 0-1","Обтиснення стінки на ділянці 1-2","ρ гр","δ 1","δ 2","Коефіцієнт сумарної витяжки в перетині 1","Коефіцієнт сумарної витяжки в перетині 2","Ступінь деформації в перетині 1","Ступінь деформації в перетині 2","Опір деформації в перетині 1","Опір деформації в перетині 2","Контактний тиск 1 для зони випередження","Контактний тиск 2 для зони випередження","Контактний тиск 1 для зони відставання","Контактний тиск 2 для зони відставання","Середній контактний тиск 1 в перетині двузонного осередку деформації","Середній контактний тиск 2 в перетині двузонного осередку деформації"],serviceModule.roundNumericArrayValues(Object.values(deformation),2),["мм","мм","мм","--","--","--","--","%","%","МПа","МПа","МПа","МПа","МПа","МПа","МПа","МПа"]],"domDeformationTable")}function s(){t([["Довжина однієї секції","Товщина стінки на початку","Коефіцієнт обтиснення стінки","Коефіцієнт обтиснення стінки в кожному перетині","Товщина стінки в кожному перетині","Зниження профілю планки на початку","Зниження профілю планки в кожному перетині","Виоста підкладок на початку","Висота підкладок в кожному перетині"],serviceModule.roundNumericArrayValues(Object.values(guidePlaneProfile),2),["мм","мм","мм","мм","мм","мм","мм","мм","мм"]],"domGuidePlaneProfileTable")}function c(){t([["Коефіцієнт витяжки","Лінійне зміщення","Годинна продуктивність"],serviceModule.roundNumericArrayValues(Object.values(productivity)),["--","мм","м/год"]],"domProductivityTable")}return{addObjectToTable:e,addArraysToTable:t,transpose:i,clearTables:n,clearByBtn:o,renderRollSizeTable:r,renderGuidePlaneTable:l,renderGuidePlaneProfileTable:s,renderDeformationTable:a,renderProductivityTable:c}}(),eventHandler=function(){function e(){var e=cacheDomModule.cacheMill(),t=cacheDomModule.cacheRoute();rollSize=calcModule.calcRollSize(e,t),guidePlane=calcModule.calcGuidePlaneSize(e,t),guidePlaneProfile=calcModule.calcGuidePlaneProfile(e,t),renderModule.clearTables(),renderModule.renderRollSizeTable(),renderModule.renderGuidePlaneTable(),renderModule.renderGuidePlaneProfileTable()}function t(){var e=cacheDomModule.cacheMill(),t=cacheDomModule.cacheRoute(),i=cacheDomModule.cacheMaterial();rollSize=calcModule.calcRollSize(e,t),guidePlane=calcModule.calcGuidePlaneSize(e,t),guidePlaneProfile=calcModule.calcGuidePlaneProfile(e,t),deformation=calcModule.calcDeformation(e,t,i),renderModule.clearTables(),renderModule.renderDeformationTable()}function i(){var e=cacheDomModule.cacheMill(),t=cacheDomModule.cacheRoute();cacheDomModule.cacheMaterial();productivity=calcModule.calcProductivity(e,t),renderModule.clearTables(),renderModule.renderProductivityTable()}function n(){renderModule.clearTables()}$(document).on("click","#calcInstrument",e),$(document).on("click","#calcDeformation",t),$(document).on("click","#calcProductivity",i),$(document).on("click","#clearCalc",n)}();$(document).ready(function(){!function(){$("#calcFormInner input").on("keyup blur",function(){$("#calcFormInner").valid()?$("button.calc-btn").prop("disabled",!1):$("button.calc-btn").prop("disabled","disabled")})}(),$.validator.setDefaults({errorClass:"help-block",highlight:function(e){$(e).closest("input").addClass("uk-form-danger")},unhighlight:function(e){$(e).closest("input").removeClass("uk-form-danger")},errorPlacement:function(e,t){"checkbox"===t.prop("type")?e.insertAfter(t.parent()):e.insertAfter(t)}}),function(){$("#calcFormInner").validate({rules:{billetDiameterInitial:{required:!0,range:function(e){return"mill_8_15"==$(".millSelect").val()?[9,17]:"mill_15_30"==$(".millSelect").val()?[16,33]:"mill_30_60"==$(".millSelect").val()?[31.5,65]:"mill_60_120"==$(".millSelect").val()?[62,168]:void 0}},billetDiameterFinal:{required:!0,range:function(e){return"mill_8_15"==$(".millSelect").val()?[8,15]:"mill_15_30"==$(".millSelect").val()?[15,30]:"mill_30_60"==$(".millSelect").val()?[30,60]:"mill_60_120"==$(".millSelect").val()?[60,120]:void 0}},billetWallThicknessInitial:{required:!0,range:function(e){return"mill_8_15"==$(".millSelect").val()?[.08,1.5]:"mill_15_30"==$(".millSelect").val()?[.15,1.5]:"mill_30_60"==$(".millSelect").val()?[.3,4]:"mill_60_120"==$(".millSelect").val()?[.6,6]:void 0}},billetWallThicknessFinal:{required:!0,range:function(e){return"mill_8_15"==$(".millSelect").val()?[.08,1.5]:"mill_15_30"==$(".millSelect").val()?[.15,1.5]:"mill_30_60"==$(".millSelect").val()?[.3,4]:"mill_60_120"==$(".millSelect").val()?[.6,6]:void 0}},billetLengthInitial:{required:!0,range:function(e){return"mill_8_15"==$(".millSelect").val()?[1,4]:"mill_15_30"==$(".millSelect").val()?[2.5,5]:"mill_30_60"==$(".millSelect").val()?[2.5,5]:"mill_60_120"==$(".millSelect").val()?[2.5,5]:void 0}},pauseTime:{required:!0}}})}()});